# 移动端基础概念

## 1. 屏幕

### 1.1 屏幕尺寸

指屏幕的对角线的长度，单位是英寸，1 英寸=2.54 厘米。

常见的屏幕尺寸有 2.4、2.8、3.5、3.7、4.2、5.0、5.5、6.0 等。

### 1.2 屏幕分辨率

- 指屏幕在横纵方向上的像素点数，单位是 px，1px = 1 个像素点。
- 买手机的时候会有一个 n x m 的分辨率，那是屏幕的 n x m 个呈像的点，一个点（小方格）为一个物理像素。它是屏幕能显示的最小粒度
- 被称作设备像素也被称为物理像素,他是显示设备中一个最微小的物理部件。每个像素可以根据操作系统设置自己的颜色和亮度。
- 任何设备的物理像素的数量都是固定的任何一款设备上，1 物理像素的大小是不会变的，不同设备上 1 物理像素的大小可能是不一样的

> Full HD(全高清): 1920 _ 1080 分辨率，iphone7p 就是这个。
> 4K 屏: 也叫 QHD 或 UHD(超高清)，最小分辨率是 3840 _ 2160，电视用的多
> 设备相机的像素：
> 640 *480 = 307200 = 30 万像素
> 1600 *1200 = 1920000 = 200 万像素
> 3264 *2488 = 8120832 = 800 万像素
> 4536 *3024 = 13716864 = 1400 万像素

> 常见苹果系统屏幕分辨率：
>
> •苹果系列手机的屏幕分辨率
>
> • 型号 屏幕分辨率 PPI
>
> • 3GS 320x480 163
>
> • 4(s) 640x960 326
>
> • 5c 640x1136 326
>
> • 5(s) 640x1136 326
>
> • 6 750x1334 326
>
> • 6+ (1242x2208 --- 1080x1920 ） 401

### 1.3 屏幕像素密度/像素密度/屏幕密度

- 屏幕上每英寸可以显示的像素点的数量，单位是 ppi，即“pixels per inch”的缩写。

- 屏幕像素密度与屏幕尺寸和屏幕分辨率有关，在单一变化条件下，屏幕尺寸越小、分辨率越高，像素密度越大，反之越小。

- 比如 iphone 3GS 和 iphone4，屏幕尺寸一样，屏幕分辨率相差一倍，屏幕像素密度也相差一倍

### 1.4 高清屏

- 高清屏（Retina）概念的兴起主要是从乔帮主发布 Retina 设备开始兴起。主要功能如下：

  具备足够高的物理像素密度而使人体肉眼无法分辨其中单独像素点的液晶屏。

- 特点如下：

​ 1.一种具备超高像素密度的液晶屏；

​ 2.同样大小屏幕上显示的像素点由一个变为多个

- 高清屏和普通屏的主要区别： 高清屏（Retina）和普通屏相比，相同区域的物理像素点数，高清屏是普通屏的 4 倍

## 2. 像素

### 2.1 三种像素

#### 2.1.1 设备像素

- **设备像素（Device Pixel）**也被称为**物理像素**,他是显示设备中一个最微小的物理部件。
- 每个像素可以根据操作系统设置自己的颜色和亮度。
- 任何设备的物理像素的数量都是固定的。

#### 2.1.2 CSS 像素

- **CSS 像素（CSS Pixel）** 也被称为**逻辑像素**。

- CSS 像素是一个抽象的单位，主要使用在浏览器上，用来精确的度量（确定）Web 页面上的内容。

- 它是为 web 开发者创造的，在 css 或者 javascript 中使用的一个抽象的层，指的是我们在样式代码中使用到的逻辑像素，是一个抽象概念，实际并不存在。

- CSS 像素与物理像素的关系：

  - 在一个标准的显示密度下(普通屏)，一个 CSS 像素对应着一个设备像素。
  - 一个 width 为 200px 的元素，它占据了 200 个 css 像素，但 200 个 css 像素占据多少个物理像素取决于屏幕的特性（是否是高密度,即像素比）和用户的缩放行为。用户把页面放大(手指向外滑动，看到元素变大)一倍，那么 css 中 1px 所代表的物理像素也会增加一倍。100px 的 div 不管放大缩小永远都是 100px，因为这就是元素单位

  - 在苹果的视网膜屏幕上，视网膜的像素密度是普通屏幕的两倍，这个元素就跨越了 400 个设备像素。

  - 如果用户放大，它将跨越更多的设备像素

#### 2.1.3 设备独立像素

- **设备独立像素（Device Independent Pixel）**,也叫**与设备无关像素**，也叫密度无关像素。

- 代表可以通过程序控制使用的虚拟像素。

  > 我们可以把设备独立像素看成是设备提供出来的接口，
  >
  > 它用来对接应用的一些概念：比如浏览器中的 css 像素
  >
  > 只有当浏览器厂商对接上设备独立像素时，浏览器厂商设计的移动端规则才能启作用

### 2.2 设备像素比

**设备像素比 （devicePixelRatio）** 简称 **DPR** ，有些地方也会称作**缩放因子**; 它的官方的定义为：设备物理像素和设备独立像素的比例。

像素比 = 一个方向上占满一块屏幕需要的物理像素的个数/一个方向上占满一块屏幕需要的设备独立像素的个数

**计算公式:**

```
DPR = 物理像素 /独立像素
```

**JavaScript 中获取屏幕的 DPR:**

```js
window.devicePixelRatio; //可以得到屏幕像素比
```

**各 iphone 版本 屏幕参数比较:**

| 设备         | 屏幕大小(英寸) | 物理分辨率(px) | 逻辑分辨率(px) | 像素密度(ppi) | 像素比(dpr) |
| ------------ | -------------- | -------------- | -------------- | ------------- | ----------- |
| 2G/3/3GS     | 3.5            | 320 x 480      | 320 x 480      | 163 ppi       | 1 dpr       |
| 4/4s         | 3.5            | 640 x 960      | 320 x 480      | 326 ppi       | 2 dpr       |
| 5/5c/5s/SE   | 4.0            | 640 x 1136     | 320 x 568      | 326 ppi       | 2 dpr       |
| 6/6s/7/8     | 4.7            | 750 x 1334     | 375 x 667      | 326 ppi       | 2 dpr       |
| 6p/6sp/7p/8p | 5.5            | 1242 x 2208    | 414 x 736      | 401 ppi       | 3 dpr       |
| x/xs         | 5.8            | 1125 x 2436    | 375 x 812      | 401 ppi       | 3 dpr       |
| xr           | 6.1            | 828 x 1792     | 414 x 896      | 326 ppi       | 2 dpr       |
| xsMax        | 6.5            | 1242 \* 2688   | 414 x 896      | 401 ppi       | 3 dpr       |

当设备像素比为 1:1 时，使用 1（1×1）个设备像素显示 1 个 CSS 像素；

当设备像素比为 2:1 时，使用 4（2×2）个设备像素显示 1 个 CSS 像素；

当设备像素比为 3:1 时，使用 9（3×3）个设备像素显示 1 个 CSS 像素。

### 2.3 位图像素

- 一个位图像素是栅格图像(如：png, jpg, gif 等)最小的数据单元
- 1 个位图像素对应于 1 个物理像素，图片才能得到完美清晰的展示

### 2.4 像素总结

- 对于 web 开发者而言：我们使用的每一个 css 和 javascript 定义的像素本质上代表的都是 css 像素，我们在开发过程中并不在意一个 css 像素到底跨越了多少个物理像素。我们将这个依赖于屏幕特性和用户缩放程度的复杂计算交给了浏览器
- 物理像素是设备呈像的最小单元
- css 像素是一个抽象的层，是 web 开发中的最小单元
- 位图像素是图片的最小单元。
- 设备独立像素也是一个抽象的层，是设备提供出来的接口
- 像素比： 物理像素 /设备独立像素

## 3. 视口 viewport

### 3.1 视口的概念

**视口 (viewport)** 是用户网页的可视区域。

在 CSS 标准文档中，**视口 (viewport)** 被称为初始包含块, 这个初始包含块是所有 CSS 百分比宽度推算的根源，它给 CSS 布局限制了一个最大宽度。

在 PC 端，视口的宽度和浏览器窗口的宽度一致。而在移动端，视口分为布局视口(layout viewport)、视觉视口(visual viewport)和理想视口(ideal viewport)。

### 3.2 PC 端视口

在 PC 端，视口指的是浏览器的可视区域，其宽度和浏览器窗口的宽度保持一致。我们改变浏览器窗口的大小，视口也随之改变

### 3.3 移动端视口

#### 3.1 布局视口 Layout Viewport

- 布局视口是在 html 元素之上的容器(包含块)，我们的页面就“装”在布局视口中。

- 设想一下，我们给 html 设置 `html{width: 100%}`, 这个 100%是基于什么计算出来的呢？ 根据定义**如果某些属性被赋予一个百分值的话，它的计算值是由这个元素的包含块计算而来的**， 而 html 的包含块就是**布局视口**，它是所有 CSS 百分比推算的根源，如果说 CSS 是一支画笔，那么布局视口就是那张画布吧。

- **获取布局视口的大小**

```javascript
document.documentElement.clientWidth;
document.documentElement.clientHeiht;
```

- 手机上，为了容纳为桌面浏览器设计的网站，默认的布局视口的宽度远大于屏幕的宽度

- 布局视口的出现，在极大程度上帮助了桌面网站到移动设备上的转移。

> 网页设计定宽是我们日常最常见的形式，主流的宽度有 960px / 980px / 1190px / 1210px 等。那么为什么会出现这几个宽度，而不是我们想象中显示器分辨率常见宽如 1024、1280 呢？
>
> 假设我们确定了 1024 宽的支持起点，那就还要再做一件事，确定一个主内容的区域宽出来。在我们使用 Word 的时候，大家都知道我们会给 A4 纸面设置一种参数类型叫页边距，不会让文字内容直接贴在纸张边缘上。

在移动端,浏览器厂商面临着一个比较大的问题,他们如何将数以万计甚至可以说是数以亿计的 pc 端网页完整的呈现在移动端设备上,并且不会出现横向滚动条?

> 这个时候,视口的宽度还是和浏览器窗口的宽度一致?我们都知道 pc 端网页一般都为 960px 或者 1024px，那么要完整的放下它们，我们移动端浏览器必须要有个容器放下它吧，而且只有有了这个容器我们才能很好的规定移动端的浏览器到底能放下多大的页面（可能大于 960 页可能大于 1024）。这个数值最好大于 960，而且设备间的这个容器大小是没有太大差异的。
>
> 这个容器我们称为布局视口

#### 3.2 视觉视口 Visual Viewport

视觉视口是指用户通过设备屏幕看到的区域，可以通过缩放来改变视觉视口的大小。

![img](http://learn.fuming.site/front-end/WEB%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/basics/images/05.visual_viewport.png)

**计算视觉视口的大小:**

```javascript
window.innerWidth;
window.inenrHeight;
```

移动款可以双指缩放，缩放改变的是 CSS 像素的大小，放大时 CSS 像素增大，则一个 CSS 像素可以跨越更多的设备像素，视觉视口会变小。

**放大会使视觉视口变小**：因为视觉视口也是通过 CSS 像素度量，而放大就是使 CSS 像素放大，假设屏幕上本来需要 200 个 CSS 像素才能占满屏幕，由于放大，现在只需要 100 个 CSS 像素就能占满，所以视觉视口的宽就变成 100px。

#### 3.3 理想视口 Ideal Viewport

- 布局视口的默认宽度并不是一个理想的宽度，对于我们移动设备来说，最理想的情况是用户刚进入页面时不再需要缩放。这就是为什么苹果和其他效仿苹果的浏览器厂商会引进理想视口

- 只有是专门为移动设备开发的网站，他才有理想视口这一说。而且只有当你在页面中加入 viewport 的 meta 标签，理想视口才会生效。

对于进行了移动适配的网页，我们希望让布局视口跟设备屏幕宽度一样大，这就就是理想的布局视口

**设置理想视口：**

```html
<meta name="viewport" content="width=device-width" />
```

- 理想视口包含的 css 像素的个数等于独立设备像素的值

  > 如果布局视口的宽度=device-width(设备宽度，也就是:物理像素/dpr)时，此时页面 100%的宽度正好能在视觉视口中完全显示，不需要缩放查看页面了,而且在不同尺寸下都能基本表现一致，此时的布局视口的状态我们就称为**理想视口（\*\***ideal viewport\***\*）**
  >
  > 第一，不需要用户缩放和横向滚动条就能正常的查看网站的所有内容；
  > 第二，显示的文字的大小是合适，比如一段 14px 大小的文字，不会因为在一个高密度像素的屏幕里显示得太小而无法看清，理想的情况是这段 14px 的文字无论是在何种密度屏幕，何种分辨率下，显示出来的大小都是差不多的。当然，不只是文字，其他元素像图片什么的也是这个道理。
  >
  > 也就是当布局视口的宽度 等于 设备独立像素的宽度时就是理想视口

## 4. 缩放

### 4.1 用户缩放

从技术层面上来讲,缩放就是放大或缩小 css 像素面积的过程,改变的是视觉视口的尺寸

> 放大
>
> ​ 会使一个 css 像素的面积变大
>
> ​ 一个 css 像素所包含的物理像素变多
>
> ​ 视觉视口所包含的 css 像素的个数变少（视觉视口应该包含你设备独立像素值所对应的 css 像素）

#### 4.1.1 PC

缩放会改变视口，影响 pc 端的布局。改变布局视口的尺寸。

#### 4.1.2 移动端

缩放会改变视觉视口的尺寸，不会改变布局视口的尺寸，不影响布局。

### 4.2 系统缩放

只有移动端才可以进行系统缩放。

通过 meta 设置 initial-scale 可以设置系统缩放系数：

```html
<meta name="viewport" content="initial-scale=1.0" />
```

initial-scale 是基于理想视口进行计算的, 值在 0.0 ~ 10.0 之间。

系统缩放 改变视觉视口的同时也会改变布局视口的宽度。

`initial-scale` 如果设置为 2.0， 布局视口会变为屏幕宽度的 1/2， 视觉视口也会变为屏幕宽度的 1/2。

> visual viewport 宽度 = ideal viewport 宽度 / 当前缩放值

## 5. Meta&Viewport

### 5.1 ViewPort 相关属性

| 属性名        | 取值                   | 描述                                                  |
| ------------- | ---------------------- | ----------------------------------------------------- |
| width         | 正整数或 device-width  | 定义视口的宽度，单位为像素                            |
| height        | 正整数或 device-height | 定义视口的高度，单位为像素，一般不用                  |
| initial-scale | [0.0-10.0]             | 定义初始缩放值                                        |
| maximum-scale | [1.0-10.0]             | 定义放大最大比例，它必须小于或等于 maximum-scale 设置 |
| minimum-scale | [0.0-1.0]              | 定义缩小最小比例，它必须大于或等于 minimum-scale 设置 |
| user-scalable | yes / no               | 定义是否允许用户手动缩放页面，默认值 yes              |

### 5.2 注意事项

- viewport 标签只对移动端浏览器有效，对 PC 端浏览器是无效的
- 即使设置了 user-scalable = no，在 Android Chrome 浏览器中也可以强制启用手动缩放；ios 上的 Safari 浏览器也是无效的

### 5.3 太大的元素

- 你的 meta 标签只使用 width=device-width，initial-scale=1.0 中的一个，遇到太大的元素时，浏览器的布局视口会尽量的包裹住元素

- 这里的兼容性很复杂，但你两个都使用了，大部分浏览器都不会改变布局视口了.

- •解决方案：使用完美视口：

### 5.4 完美视口

```html
<meta
  name="viewport"
  content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
/>
```
